name: Kentyou Default CI Build

# Kentyou Default CI Build
#
# Automates Java builds and tests for commits to main branch and PRs,
# using JDK 17 and caching Maven dependencies.
#
# Deploys artifacts to GitHub Packages on main branch commits.
#
# Note: Ignores all tags as they are checked and built
#       using the tag-publish.yml workflow.
#
# The "source" version of this workflow is in our .github repository.

on:
  push:
    branches: [ "main" ]
  pull_request:
    branches: [ "main" ]

jobs:
  build:

    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@0ad4b8fadaa221de15dcec353f45205ec38ea70b # v4.1.4
    - name: Set up JDK 17
      uses: actions/setup-java@99b8673ff64fbf99d8d325f52d9a5bdedb8483e9 # v4.2.1
      with:
        java-version: '17'
        distribution: 'temurin'
        cache: maven
    - name: CI Build
      uses: kentyou/build-automation/actions/maven-build@f08ff697ccd326ae99f9dc675a7b1b201029f5c2 # v1.1.0
      with:
        deploy-gh-packages: ${{ github.ref == 'refs/heads/main'}}
        repo-secret: ${{ secrets.KENTYOU_CI_PAT }}
